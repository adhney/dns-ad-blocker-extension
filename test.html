<!DOCTYPE html>
<html>
  <head>
    <title>DNS Ad Blocker Test Page</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      .test-item {
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
      }
      .blocked {
        background-color: #fee;
      }
      .allowed {
        background-color: #efe;
      }
    </style>
  </head>
  <body>
    <h1>DNS Ad Blocker Test Page</h1>
    <p>This page helps test if the DNS ad blocker is working correctly.</p>

    <div class="test-item">
      <h3>Test 1: Google Analytics (should be blocked)</h3>
      <img
        src="https://www.google-analytics.com/collect?v=1&tid=UA-XXXXX-Y&cid=555&t=pageview&dp=%2Ftest"
        alt="GA Test"
        width="1"
        height="1"
        style="display: none"
      />
      <p>
        If this request is blocked, you won't see an error in the network tab.
      </p>
    </div>

    <div class="test-item">
      <h3>Test 2: DoubleClick (should be blocked)</h3>
      <img
        src="https://googleads.g.doubleclick.net/test"
        alt="DoubleClick Test"
        width="1"
        height="1"
        style="display: none"
      />
      <p>DoubleClick requests should be blocked by the DNS filter.</p>
    </div>

    <div class="test-item">
      <h3>Test 3: Regular image (should load)</h3>
      <img
        src="https://via.placeholder.com/100x50/0066cc/ffffff?text=Allowed"
        alt="Test Image"
      />
      <p>This image should load normally as it's not from an ad domain.</p>
    </div>

    <div class="test-item">
      <h3>Test 4: Facebook tracking (should be blocked)</h3>
      <img
        src="https://www.facebook.com/tr?id=123456789&ev=PageView"
        alt="FB Test"
        width="1"
        height="1"
        style="display: none"
      />
      <p>Facebook tracking pixel should be blocked.</p>
    </div>

    <script>
      // Test script to check if certain domains are accessible
      async function testDomain(domain, name) {
        try {
          const response = await fetch(`https://${domain}/favicon.ico`, {
            method: "HEAD",
            mode: "no-cors",
          });
          console.log(`${name} (${domain}): Allowed`);
          return false; // Not blocked
        } catch (error) {
          console.log(`${name} (${domain}): Blocked`);
          return true; // Blocked
        }
      }

      // Run tests
      setTimeout(async () => {
        console.log("Starting DNS Ad Blocker tests...");
        await testDomain("google-analytics.com", "Google Analytics");
        await testDomain("doubleclick.net", "DoubleClick");
        await testDomain("googleadservices.com", "Google Ad Services");
        await testDomain("facebook.com", "Facebook");
        console.log(
          "Tests completed. Check the network tab to see blocked requests."
        );
      }, 2000);
    </script>
  </body>
</html>
